#!/bin/bash
# postrm script
#
# see: dh_installdeb(1)

function unlink_if_existing() {
    if [ -L "$1" ]; then
        unlink $1
    fi
}

# cleanup and unlink our symlinks
unlink_if_existing /etc/nginx/nginx.conf
unlink_if_existing /etc/nginx/sites-enabled/wlanpi_core.conf

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

# cleanup our users we created during postinst
APIUSER="wlanpi_api"
USER_EXISTS=$(getent passwd $APIUSER)

if [ -z "$USER_EXISTS" ]; then
    echo "User $APIUSER does not exist..."
else
    echo "User $APIUSER exists, deleting..."
    deluser "$APIUSER" --only-if-empty
fi

#DEBHELPER#

exit 0
